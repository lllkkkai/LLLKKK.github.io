---
layout: post
category: Design
---

# 如何设计一个好接口
《API Design Patterns》 这本书中提了四个要点：

- 可使用（Operational）：这一点是毋庸置疑的，接口必须要能完成它提供的能力。可使用是最基本的能力。如果使用者的环境稍微发生了一点变化，接口就不工作了，这就与可使用相违背。
- 富于表现力（Expressive）：与可使用同样重要的是，借助接口，用户要能够清晰表达他们想要做的事情。
- 简单（Simple）：爱因斯坦说过“一切应当尽可能简单，不过不能关于简单”。你需要仔细思考，考虑清楚要简单到哪一个层次对于使用者来说是最合适的。例如，对于描述“开关”功能，给普通用户来说，只需要“开”和“关”两个操作就可以了。但是如果是给电工使用，那可能还需要更多的操作。你需要仔细思考用户是什么样的人群。
- 可预测（Predictable）：“可预测”的反面是“出乎意料”，虽然这个词和“惊喜”有些近义。但对于API来说，不需要任何惊喜。API应当始终一致的照着接口的契约完成使命。如果接口的契约不包含出错和异常的情况，那这个API被调用1000，10000遍，都不应该出现任何异常。当然，如果实际情况是有可能出错或者失败的，那就在接口描述里面说清楚什么情况下会出什么错，并准确的在相应的时机返回相应的错误。

设计接口需要关注的点：
1. 接口参数校验
2. 接口兼容性
3. 设计接口时，充分考虑可扩展性
4. 保障接口的安全性
5. 是否要做防重/幂等
6. 调用外部接口考虑异常和超时处理
7. 复杂调用考虑熔断
8. 功能定义要具有单一性
9. 某些场景考虑异步
10. 性能优化考虑批处理思想
11. 恰当使用缓存
12. 热点数据隔离
13. 数据量大要考虑分页
14. 接口本身的异常处理
15. 代码规范与版本控制 